"use strict";(self["webpackChunkjingdong"]=self["webpackChunkjingdong"]||[]).push([[883],{931:function(t,e,a){a.d(e,{K:function(){return n}});var s=a(782),c=a(6768);const n=t=>{const e=(0,s.Pj)(),a=e.state.cartList,n=(t,a,s,c)=>{e.commit("changeCartItemInfo",{shopId:t,productId:a,productInfo:s,num:c})},o=(0,c.EW)((()=>{const e=a[t]?.productList||[],s={};for(const t in e){const a=e[t];a.count>0&&(s[t]=a)}return s})),r=(0,c.EW)((()=>{const e=a[t]?.shopName||[];return e})),i=(0,c.EW)((()=>{const e=a[t]?.productList,s={total:0,price:0,allChecked:!0};if(e)for(const t in e){const a=e[t];s.total+=a.count,a.check&&(s.price+=a.count*a.price),a.count>0&&!a.check&&(s.allChecked=!1)}else s.allChecked=!1;return s.price=s.price.toFixed(2),s}));return{changeCartItemInfo:n,cartList:a,calculations:i,productList:o,shopName:r}}},2565:function(t,e,a){a.d(e,{A:function(){return C}});var s=a(6768),c=a(4232);const n={class:"shop"},o=["src"],r={class:"shop__content__title"},i={class:"shop__content__tags"},l={class:"shop__content__tag"},_={class:"shop__content__tag"},d={class:"shop__content__tag"},h={class:"shop__content__highlight"};function u(t,e,a,u,p,m){return(0,s.uX)(),(0,s.CE)("div",n,[(0,s.Lk)("img",{class:"shop__img",src:a.item.imgUrl},null,8,o),(0,s.Lk)("div",{class:(0,c.C4)({shop__content:!0,"shop__content--bordered":!a.hideBorder})},[(0,s.Lk)("div",r,(0,c.v_)(a.item.name),1),(0,s.Lk)("div",i,[(0,s.Lk)("span",l,"月售："+(0,c.v_)(a.item.sales),1),(0,s.Lk)("span",_,"起送："+(0,c.v_)(a.item.expressLimit),1),(0,s.Lk)("span",d,"基础运费："+(0,c.v_)(a.item.expressPrice),1)]),(0,s.Lk)("p",h,(0,c.v_)(a.item.slogan),1)],2)])}var p={name:"ShopInfo",props:["item","hideBorder"]},m=a(1241);const k=(0,m.A)(p,[["render",u],["__scopeId","data-v-dbaafe9c"]]);var C=k},8677:function(t,e,a){a.d(e,{A:function(){return h},g:function(){return l}});var s=a(6768),c=a(4232);const n={class:"toast"};function o(t,e,a,o,r,i){return(0,s.uX)(),(0,s.CE)("div",n,(0,c.v_)(a.message),1)}var r=a(144),i={name:"ToastComponent",props:["message","show"]};const l=()=>{const t=(0,r.Kh)({show:!1,toastMessage:""}),e=e=>{t.show=!0,t.toastMessage=e,setTimeout((()=>{t.show=!1,t.toastMessage=""}),1e3)},{show:a,toastMessage:s}=(0,r.QW)(t);return{show:a,toastMessage:s,showToast:e}};var _=a(1241);const d=(0,_.A)(i,[["render",o],["__scopeId","data-v-6b1409a4"]]);var h=d},8225:function(t,e,a){a.r(e),a.d(e,{default:function(){return vt}});var s=a(6768),c=a(5130);const n=t=>((0,s.Qi)("data-v-741f74b2"),t=t(),(0,s.jt)(),t),o={class:"search"},r=n((()=>(0,s.Lk)("div",{class:"search__content"},[(0,s.Lk)("span",{class:"search__content__icon iconfont"},""),(0,s.Lk)("input",{class:"search__content__input",placeholder:"请输入商品名称"})],-1))),i={class:"wrapper"};function l(t,e,a,n,l,_){const d=(0,s.g2)("ShopInfo"),h=(0,s.g2)("Content"),u=(0,s.g2)("Cart");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",o,[(0,s.Lk)("div",{class:"search__back iconfont",onClick:e[0]||(e[0]=(...t)=>n.handleBackClick&&n.handleBackClick(...t))},""),r]),(0,s.Lk)("div",i,[(0,s.bo)((0,s.bF)(d,{item:n.item,hideBorder:!0},null,8,["item"]),[[c.aG,n.item.imgUrl]]),(0,s.bF)(h,{shopName:n.item.name},null,8,["shopName"]),(0,s.bF)(u)])],64)}var _=a(144),d=a(1387),h=a(5067),u=a(2565),p=a(4232);const m=t=>((0,s.Qi)("data-v-9569120e"),t=t(),(0,s.jt)(),t),k={class:"content"},C={class:"category"},g=["onClick"],L={class:"product"},v=["src"],I={class:"product__item__detail"},f={class:"product__item__title"},b={class:"product__item__sales"},w={class:"product__item__price"},T=m((()=>(0,s.Lk)("span",{class:"product__item__yen"},"¥",-1))),E={class:"product__item__origin"},K={class:"product__number"},M=["onClick"],X=["onClick"];function y(t,e,a,c,n,o){return(0,s.uX)(),(0,s.CE)("div",k,[(0,s.Lk)("div",C,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(c.categories,(t=>((0,s.uX)(),(0,s.CE)("div",{class:(0,p.C4)({category__item:!0,"category__item--active":c.currentTab===t.tab}),key:t.tab,onClick:()=>c.handleTabClick(t.tab)},(0,p.v_)(t.name),11,g)))),128))]),(0,s.Lk)("div",L,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(c.currentList,(t=>((0,s.uX)(),(0,s.CE)("div",{class:"product__item",key:t._id},[(0,s.Lk)("img",{class:"product__item__img",src:t.imgUrl},null,8,v),(0,s.Lk)("div",I,[(0,s.Lk)("h4",f,(0,p.v_)(t.name),1),(0,s.Lk)("p",b,"月售"+(0,p.v_)(t.sales)+"件",1),(0,s.Lk)("p",w,[T,(0,s.eW)((0,p.v_)(t.price)+" ",1),(0,s.Lk)("span",E,"¥"+(0,p.v_)(t.oldPrice),1)])]),(0,s.Lk)("div",K,[(0,s.Lk)("span",{class:"product__number__minus",onClick:()=>{c.changeCartItem(c.shopId,t._id,t,-1,a.shopName)}},"-",8,M),(0,s.eW)(" "+(0,p.v_)(c.cartList?.[c.shopId]?.productList?.[t._id]?.count||0)+" ",1),(0,s.Lk)("span",{class:"product__number__plus",onClick:()=>{c.changeCartItem(c.shopId,t._id,t,1,a.shopName)}},"+",8,X)])])))),128))])])}a(4114);var W=a(782),S=a(931);const P=[{name:"全部商品",tab:"all"},{name:"秒杀",tab:"seckill"},{name:"新鲜水果",tab:"fruit"}],Q=()=>{const t=(0,_.KR)(P[0].tab),e=e=>{t.value=e};return{currentTab:t,handleTabClick:e}},A=()=>{const t=(0,d.lq)(),e=(0,_.Kh)({contentList:[]}),a=t.params.id,s=async()=>{const t=await(0,h.J)(`/shop/${a}`);0===t?.errno&&t?.data&&(e.contentList=t.data.products)},{contentList:c}=(0,_.QW)(e);return{contentList:c,getContentData:s,shopId:a}},B=(t,e)=>{const a=(0,_.Kh)({currentList:[]});(0,s.wB)([e,t],(([t,e])=>{a.currentList=[];for(let s=0;s<e.length;s++)"all"!==t&&e[s].categories!==t||a.currentList.push(e[s])}));const{currentList:c}=(0,_.QW)(a);return{currentList:c}};var F={name:"ContentComponent",props:["shopName"],setup(){const{currentTab:t,handleTabClick:e}=Q(),{contentList:a,getContentData:s,shopId:c}=A();s();const{currentList:n}=B(a,t),{changeCartItemInfo:o,cartList:r}=(0,S.K)(),i=(0,W.Pj)(),l=(t,e)=>{i.commit("changeShopName",{shopId:t,shopName:e})},_=(t,e,a,s,c)=>{o(t,e,a,s),l(t,c)};return{categories:P,handleTabClick:e,currentTab:t,currentList:n,shopId:c,changeCartItem:_,cartList:r}}},N=a(1241);const j=(0,N.A)(F,[["render",y],["__scopeId","data-v-9569120e"]]);var D=j;const x=t=>((0,s.Qi)("data-v-36a4b794"),t=t(),(0,s.jt)(),t),H={class:"cart"},U={key:0,class:"product"},q={class:"product__header"},J=["innerHTML"],R=x((()=>(0,s.Lk)("span",{class:"product__header__all__text"}," 全选",-1))),V={class:"product__header__clear"},$=["innerHTML","onClick"],G=["src"],O={class:"product__item__detail"},z={class:"product__item__title"},Y={class:"product__item__price"},Z=x((()=>(0,s.Lk)("span",{class:"product__item__yen"},"¥",-1))),tt={class:"product__item__origin"},et={class:"product__number"},at=["onClick"],st=["onClick"],ct={class:"check"},nt={class:"check__icon"},ot={class:"check__icon__tag"},rt={class:"check__info"},it={class:"check__info__price"};function lt(t,e,a,c,n,o){const r=(0,s.g2)("Toast");return(0,s.uX)(),(0,s.CE)(s.FK,null,[c.showCart?((0,s.uX)(),(0,s.CE)("div",{key:0,class:"mask",onClick:e[0]||(e[0]=(...t)=>c.handleCartShowChange&&c.handleCartShowChange(...t))})):(0,s.Q3)("",!0),(0,s.Lk)("div",H,[c.showCart?((0,s.uX)(),(0,s.CE)("div",U,[(0,s.Lk)("div",q,[(0,s.Lk)("div",{class:"product__header__all",onClick:e[1]||(e[1]=()=>c.setCartItemsChecked(c.shopId))},[(0,s.Lk)("span",{class:"product__header__icon iconfont",innerHTML:c.calculations.allChecked?"":""},null,8,J),R]),(0,s.Lk)("div",V,[(0,s.Lk)("span",{class:"product__header__clear__btn",onClick:e[2]||(e[2]=()=>c.cleanCartProducts(c.shopId))},"清空购物车")])]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(c.productList,(t=>((0,s.uX)(),(0,s.CE)("div",{key:t._id,class:"product__item"},[(0,s.Lk)("div",{class:"product__item__checked iconfont",innerHTML:t.check?"":"",onClick:e=>c.changeCartItemCheck(c.shopId,t._id)},null,8,$),(0,s.Lk)("img",{class:"product__item__img",src:t.imgUrl},null,8,G),(0,s.Lk)("div",O,[(0,s.Lk)("h4",z,(0,p.v_)(t.name),1),(0,s.Lk)("p",Y,[Z,(0,s.eW)((0,p.v_)(t.price)+" ",1),(0,s.Lk)("span",tt,"¥"+(0,p.v_)(t.oldPrice),1)])]),(0,s.Lk)("div",et,[(0,s.Lk)("span",{class:"product__number__minus",onClick:()=>{c.changeCartItemInfo(c.shopId,t._id,t,-1)}},"-",8,at),(0,s.eW)(" "+(0,p.v_)(t.count)+" ",1),(0,s.Lk)("span",{class:"product__number__plus",onClick:()=>{c.changeCartItemInfo(c.shopId,t._id,t,1)}},"+",8,st)])])))),128))])):(0,s.Q3)("",!0),(0,s.Lk)("div",ct,[(0,s.Lk)("div",nt,[(0,s.Lk)("img",{src:"http://www.dell-lee.com/imgs/vue3/basket.png",class:"check__icon__img",onClick:e[3]||(e[3]=(...t)=>c.handleCartShowChange&&c.handleCartShowChange(...t))}),(0,s.Lk)("div",ot,(0,p.v_)(c.calculations.total),1)]),(0,s.Lk)("div",rt,[(0,s.eW)(" 总计："),(0,s.Lk)("span",it,"¥ "+(0,p.v_)(c.calculations.price),1)]),(0,s.Lk)("div",{class:"check__btn",onClick:e[4]||(e[4]=()=>c.handleCheckClick(c.shopId))}," 去结算 ")])]),c.show?((0,s.uX)(),(0,s.Wv)(r,{key:1,message:c.toastMessage},null,8,["message"])):(0,s.Q3)("",!0)],64)}var _t=a(8677);const dt=(t,e)=>{const{cartList:a,calculations:s,changeCartItemInfo:c,productList:n}=(0,S.K)(t),{show:o,toastMessage:r,showToast:i}=(0,_t.g)(),l=(0,W.Pj)(),_=(0,d.rd)(),h=(t,e)=>{l.commit("changeCartItemCheck",{shopId:t,productId:e})},u=t=>{l.commit("cleanCartProducts",{shopId:t}),e.value=!1},p=t=>{l.commit("setCartItemsChecked",{shopId:t})},m=t=>{s.value.total>0?_.push({name:"OrderConfirmationView",params:{shopId:t}}):i("请先选择商品")};return{cartList:a,calculations:s,productList:n,changeCartItemInfo:c,changeCartItemCheck:h,cleanCartProducts:u,setCartItemsChecked:p,show:o,toastMessage:r,handleCheckClick:m}},ht=()=>{const t=(0,_.KR)(!1),e=()=>{t.value=!t.value};return{showCart:t,handleCartShowChange:e}};var ut={components:{Toast:_t.A},name:"CartComponent",setup(){const t=(0,d.lq)(),e=t.params.id,{showCart:a,handleCartShowChange:s}=ht(),{calculations:c,productList:n,changeCartItemInfo:o,changeCartItemCheck:r,cleanCartProducts:i,setCartItemsChecked:l,show:_,toastMessage:h,handleCheckClick:u}=dt(e,a);return{shopId:e,productList:n,changeCartItemInfo:o,changeCartItemCheck:r,cleanCartProducts:i,calculations:c,setCartItemsChecked:l,showCart:a,handleCartShowChange:s,show:_,toastMessage:h,handleCheckClick:u}}};const pt=(0,N.A)(ut,[["render",lt],["__scopeId","data-v-36a4b794"]]);var mt=pt;const kt=()=>{const t=(0,d.lq)(),e=(0,_.Kh)({item:{}}),a=async()=>{const a=await(0,h.J)(`/shop/${t.params.id}`);0===a?.errno&&a?.data&&(e.item=a.data)},{item:s}=(0,_.QW)(e);return{item:s,getItemData:a}},Ct=()=>{const t=(0,d.rd)(),e=()=>{t.back()};return{handleBackClick:e}};var gt={name:"ShopView",components:{ShopInfo:u.A,Cart:mt,Content:D},setup(){const{item:t,getItemData:e}=kt(),{handleBackClick:a}=Ct();return e(),{item:t,handleBackClick:a,getItemData:e}}};const Lt=(0,N.A)(gt,[["render",l],["__scopeId","data-v-741f74b2"]]);var vt=Lt}}]);
//# sourceMappingURL=shop.39ff3b86.js.map