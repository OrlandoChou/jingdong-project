"use strict";(self["webpackChunkjingdong"]=self["webpackChunkjingdong"]||[]).push([[390],{931:function(s,t,a){a.d(t,{K:function(){return n}});var e=a(782),o=a(6768);const n=s=>{const t=(0,e.Pj)(),a=t.state.cartList,n=(s,a,e,o)=>{t.commit("changeCartItemInfo",{shopId:s,productId:a,productInfo:e,num:o})},c=(0,o.EW)((()=>{const t=a[s]?.productList||[],e={};for(const s in t){const a=t[s];a.count>0&&(e[s]=a)}return e})),r=(0,o.EW)((()=>{const t=a[s]?.shopName||[];return t})),i=(0,o.EW)((()=>{const t=a[s]?.productList,e={total:0,price:0,allChecked:!0};if(t)for(const s in t){const a=t[s];e.total+=a.count,a.check&&(e.price+=a.count*a.price),a.count>0&&!a.check&&(e.allChecked=!1)}else e.allChecked=!1;return e.price=e.price.toFixed(2),e}));return{changeCartItemInfo:n,cartList:a,calculations:i,productList:c,shopName:r}}},5742:function(s,t,a){a.d(t,{A:function(){return g}});var e=a(6768),o=a(4232);const n=s=>((0,e.Qi)("data-v-05bca0a9"),s=s(),(0,e.jt)(),s),c={class:"products"},r={class:"products__title"},i={class:"products__list"},d=["src"],_={class:"products__item__detail"},l={class:"products__item__title"},p={class:"products__item__price"},u={class:"products__item__single"},v=n((()=>(0,e.Lk)("span",{class:"products__item__yen"},"¥",-1))),m={class:"products__item__total"},h=n((()=>(0,e.Lk)("span",{class:"products__item__yen"},"¥",-1)));function k(s,t,a,n,k,f){return(0,e.uX)(),(0,e.CE)("div",c,[(0,e.Lk)("div",r,(0,o.v_)(a.shopName),1),(0,e.Lk)("div",i,[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)(a.productList,(s=>((0,e.uX)(),(0,e.CE)("div",{class:"products__item",key:s._id},[(0,e.Lk)("img",{class:"products__item__img",src:s.imgUrl},null,8,d),(0,e.Lk)("div",_,[(0,e.Lk)("h4",l,(0,o.v_)(s.name),1),(0,e.Lk)("p",p,[(0,e.Lk)("span",u,[v,(0,e.eW)(" "+(0,o.v_)(s.price)+" * "+(0,o.v_)(s.count),1)]),(0,e.Lk)("span",m,[h,(0,e.eW)(" "+(0,o.v_)((s.price*s.count).toFixed(2)),1)])])])])))),128))])])}var f={name:"ProductList",props:["productList","shopName"]},C=a(1241);const L=(0,C.A)(f,[["render",k],["__scopeId","data-v-05bca0a9"]]);var g=L},8677:function(s,t,a){a.d(t,{A:function(){return p},g:function(){return d}});var e=a(6768),o=a(4232);const n={class:"toast"};function c(s,t,a,c,r,i){return(0,e.uX)(),(0,e.CE)("div",n,(0,o.v_)(a.message),1)}var r=a(144),i={name:"ToastComponent",props:["message","show"]};const d=()=>{const s=(0,r.Kh)({show:!1,toastMessage:""}),t=t=>{s.show=!0,s.toastMessage=t,setTimeout((()=>{s.show=!1,s.toastMessage=""}),1e3)},{show:a,toastMessage:e}=(0,r.QW)(s);return{show:a,toastMessage:e,showToast:t}};var _=a(1241);const l=(0,_.A)(i,[["render",c],["__scopeId","data-v-6b1409a4"]]);var p=l},2569:function(s,t,a){a.r(t),a.d(t,{default:function(){return q}});var e=a(6768);const o={class:"wrapper"};function n(s,t,a,n,c,r){const i=(0,e.g2)("TopArea"),d=(0,e.g2)("ProductList"),_=(0,e.g2)("Order");return(0,e.uX)(),(0,e.CE)(e.FK,null,[(0,e.Lk)("div",o,[(0,e.bF)(i,{class:"top__area"}),(0,e.bF)(d,{productList:n.productList,shopName:n.shopName},null,8,["productList","shopName"])]),(0,e.bF)(_)],64)}var c=a(1387),r=a(931);const i=s=>((0,e.Qi)("data-v-2c7d2a16"),s=s(),(0,e.jt)(),s),d={class:"top"},_=i((()=>(0,e.Lk)("div",{class:"top__bgColor"},null,-1))),l={class:"top__header"},p=i((()=>(0,e.Lk)("span",{class:"top__header__text"},"确认订单",-1))),u=(0,e.Fv)('<div class="top__receiver" data-v-2c7d2a16><div class="top__receiver__title" data-v-2c7d2a16>收货地址</div><div class="top__receiver__address" data-v-2c7d2a16>合肥工业大学北京校区</div><div class="top__receiver__info" data-v-2c7d2a16><span class="top__receiver__info__name" data-v-2c7d2a16>瑶妹 (先生)</span><span class="top__receiver__info__name" data-v-2c7d2a16>12345654321</span></div><div class="iconfont top__receiver__icon" data-v-2c7d2a16></div></div>',1);function v(s,t,a,o,n,c){return(0,e.uX)(),(0,e.CE)("div",d,[_,(0,e.Lk)("div",l,[(0,e.Lk)("div",{class:"iconfont top__header__back",onClick:t[0]||(t[0]=(...s)=>o.handleBackClick&&o.handleBackClick(...s))},""),p]),u])}var m={name:"TopArea",setup(){const s=(0,c.rd)(),t=()=>{s.back()};return{handleBackClick:t}}},h=a(1241);const k=(0,h.A)(m,[["render",v],["__scopeId","data-v-2c7d2a16"]]);var f=k,C=a(5742),L=a(4232),g=a(5130);const w=s=>((0,e.Qi)("data-v-1aab7cfc"),s=s(),(0,e.jt)(),s),b={class:"order"},I={class:"order__price"},A=w((()=>(0,e.Lk)("span",{class:"order__price__text"},"实付金额 ",-1))),E={class:"order__price__num"},M={class:"mask__content"},N=w((()=>(0,e.Lk)("h3",{class:"mask__content__title"},"确认要离开收银台",-1))),O=w((()=>(0,e.Lk)("p",{class:"mask__content__desc"},"请尽快完成支付，否则将被取消",-1))),F={class:"mask__content__btns"};function T(s,t,a,o,n,c){const r=(0,e.g2)("Toast");return(0,e.uX)(),(0,e.CE)(e.FK,null,[(0,e.Lk)("div",b,[(0,e.Lk)("div",I,[A,(0,e.Lk)("span",E,[(0,e.eW)(" ¥"),(0,e.Lk)("b",null,(0,L.v_)(o.calculations.price),1)])]),(0,e.Lk)("div",{class:"order__btn",onClick:t[0]||(t[0]=()=>o.handleShowConfirmChange(!0))},"提交订单")]),(0,e.bo)((0,e.Lk)("div",{class:"mask",onClick:t[3]||(t[3]=()=>o.handleShowConfirmChange(!1))},[(0,e.Lk)("div",M,[N,O,(0,e.Lk)("div",F,[(0,e.Lk)("div",{class:"mask__content__btn mask__content__btn--first",onClick:t[1]||(t[1]=()=>o.handleConfirmOrder(!0))},"取消支付"),(0,e.Lk)("div",{class:"mask__content__btn mask__content__btn--last",onClick:t[2]||(t[2]=()=>o.handleConfirmOrder(!1))},"确认支付")])])],512),[[g.aG,o.showConfirm]]),o.show?((0,e.uX)(),(0,e.Wv)(r,{key:0,message:o.toastMessage},null,8,["message"])):(0,e.Q3)("",!0)],64)}a(4114);var K=a(144),W=a(5067),X=a(782),j=a(8677);const y=(s,t,a,e)=>{const o=(0,c.rd)(),n=(0,X.Pj)(),{show:r,toastMessage:i,showToast:d}=(0,j.g)(),_=async s=>{const e=[];for(const t in a.value){const s=a.value[t];e.push({id:parseInt(s._id,10),num:s.count,imgUrl:s.imgUrl})}try{const a=await(0,W.J)("/order");a?(s||n.commit("clearCartData",t),o.push({name:"OrderListView"})):d("没有得到回应")}catch(c){d("下单失败")}};return{show:r,toastMessage:i,handleConfirmOrder:_}},P=()=>{const s=(0,K.KR)(!1),t=t=>{s.value=t};return{showConfirm:s,handleShowConfirmChange:t}};var Q={name:"OrderComponent",components:{Toast:j.A},setup(){const s=(0,c.lq)(),t=parseInt(s.params.shopId,10),{calculations:a,shopName:e,productList:o}=(0,r.K)(t),{show:n,toastMessage:i,handleConfirmOrder:d}=y(e,t,o,a),{showConfirm:_,handleShowConfirmChange:l}=P();return{show:n,toastMessage:i,calculations:a,handleConfirmOrder:d,showConfirm:_,handleShowConfirmChange:l}}};const S=(0,h.A)(Q,[["render",T],["__scopeId","data-v-1aab7cfc"]]);var x=S,B={name:"OrderConfirmationView",components:{TopArea:f,ProductList:C.A,Order:x},setup(){const s=(0,c.lq)(),t=s.params.shopId,{productList:a,shopName:e}=(0,r.K)(t);return{productList:a,shopName:e}}};const U=(0,h.A)(B,[["render",n],["__scopeId","data-v-c7427d02"]]);var q=U}}]);
//# sourceMappingURL=orderConfirmation.77a6240d.js.map